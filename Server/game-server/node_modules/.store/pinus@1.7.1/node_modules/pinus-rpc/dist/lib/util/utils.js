"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.listEs6ClassMethods = exports.getBearcat = exports.typeMap = exports.typeArray = exports.getType = exports.isNotNull = exports.to_array = exports.checkNull = exports.checkBean = exports.checkBoolean = exports.checkString = exports.checkObject = exports.checkFunction = exports.checkNumber = exports.checkArray = exports.isType = exports.checkFloat = exports.getObjectClass = exports.applyCallback = exports.invokeCallback = void 0;
function invokeCallback(cb, err) {
    if (typeof cb === 'function') {
        cb.apply(null, Array.prototype.slice.call(arguments, 1));
    }
}
exports.invokeCallback = invokeCallback;
function applyCallback(cb, args) {
    if (typeof cb === 'function') {
        cb.apply(null, args);
    }
}
exports.applyCallback = applyCallback;
function getObjectClass(obj) {
    if (!obj) {
        return;
    }
    let constructor = obj.constructor;
    if (!constructor) {
        return;
    }
    if (constructor.name) {
        return constructor.name;
    }
    let str = constructor.toString();
    if (!str) {
        return;
    }
    let arr = null;
    if (str.charAt(0) === '[') {
        arr = str.match(/\[\w+\s*(\w+)\]/);
    }
    else {
        arr = str.match(/function\s*(\w+)/);
    }
    if (arr && arr.length === 2) {
        return arr[1];
    }
}
exports.getObjectClass = getObjectClass;
/**
 * Utils check float
 *
 * @param  {Float}   float
 * @return {Boolean} true|false
 * @api public
 */
function checkFloat(v) {
    return v === Number(v) && v % 1 !== 0;
    // return parseInt(v) !== v;
}
exports.checkFloat = checkFloat;
/**
 * Utils check type
 *
 * @param  {String}   type
 * @return {Function} high order function
 * @api public
 */
function isType(type) {
    return function (obj) {
        return {}.toString.call(obj) === '[object ' + type + ']';
    };
}
exports.isType = isType;
/**
 * Utils check array
 *
 * @param  {Array}   array
 * @return {Boolean} true|false
 * @api public
 */
exports.checkArray = Array.isArray || isType('Array');
/**
 * Utils check number
 *
 * @param  {Number}  number
 * @return {Boolean} true|false
 * @api public
 */
exports.checkNumber = isType('Number');
/**
 * Utils check function
 *
 * @param  {Function}   func function
 * @return {Boolean}    true|false
 * @api public
 */
exports.checkFunction = isType('Function');
/**
 * Utils check object
 *
 * @param  {Object}   obj object
 * @return {Boolean}  true|false
 * @api public
 */
exports.checkObject = isType('Object');
/**
 * Utils check string
 *
 * @param  {String}   string
 * @return {Boolean}  true|false
 * @api public
 */
exports.checkString = isType('String');
/**
 * Utils check boolean
 *
 * @param  {Object}   obj object
 * @return {Boolean}  true|false
 * @api public
 */
exports.checkBoolean = isType('Boolean');
/**
 * Utils check bean
 *
 * @param  {Object}   obj object
 * @return {Boolean}  true|false
 * @api public
 */
let checkBean = function (obj) {
    return obj && obj['$id'] &&
        (0, exports.checkFunction)(obj['writeFields']) &&
        (0, exports.checkFunction)(obj['readFields']);
};
exports.checkBean = checkBean;
let checkNull = function (obj) {
    return !(0, exports.isNotNull)(obj);
};
exports.checkNull = checkNull;
/**
 * Utils args to array
 *
 * @param  {Object}  args arguments
 * @return {Array}   array
 * @api public
 */
let to_array = function (args) {
    let len = args.length;
    let arr = new Array(len);
    for (let i = 0; i < len; i++) {
        arr[i] = args[i];
    }
    return arr;
};
exports.to_array = to_array;
/**
 * Utils check is not null
 *
 * @param  {Object}   value
 * @return {Boolean}  true|false
 * @api public
 */
let isNotNull = function (value) {
    if (value !== null && typeof value !== 'undefined')
        return true;
    return false;
};
exports.isNotNull = isNotNull;
let getType = function (object) {
    if (object == null || typeof object === 'undefined') {
        return exports.typeMap['null'];
    }
    if (Buffer.isBuffer(object)) {
        return exports.typeMap['buffer'];
    }
    if ((0, exports.checkArray)(object)) {
        return exports.typeMap['array'];
    }
    if ((0, exports.checkString)(object)) {
        return exports.typeMap['string'];
    }
    if ((0, exports.checkObject)(object)) {
        if ((0, exports.checkBean)(object)) {
            return exports.typeMap['bean'];
        }
        return exports.typeMap['object'];
    }
    if ((0, exports.checkBoolean)(object)) {
        return exports.typeMap['boolean'];
    }
    if ((0, exports.checkNumber)(object)) {
        if (checkFloat(object)) {
            return exports.typeMap['float'];
        }
        if (isNaN(object)) {
            return exports.typeMap['null'];
        }
        return exports.typeMap['number'];
    }
};
exports.getType = getType;
exports.typeArray = ['', 'null', 'buffer', 'array', 'string', 'object', 'bean', 'boolean', 'float', 'number'];
exports.typeMap = {};
for (let i = 1; i <= exports.typeArray.length; i++) {
    exports.typeMap[exports.typeArray[i]] = i;
}
let getBearcat = function () {
    return require('bearcat');
};
exports.getBearcat = getBearcat;
/**
 * 列出ES6的一个Class实例上的所有方法
 * @param objInstance
 * @param containParent ture 包含父类方法 默认不包含
 */
function listEs6ClassMethods(objInstance, containParent) {
    var _a;
    let names = [];
    if (objInstance.prototype && objInstance.prototype.constructor === objInstance) {
        let methodNames = Object.getOwnPropertyNames(objInstance.prototype);
        for (let name of methodNames) {
            let method = objInstance.prototype[name];
            // Supposedly you'd like to skip constructor
            if (!(method instanceof Function) || name === 'constructor')
                continue;
            names.push(name);
        }
    }
    // 包含父类方法
    else {
        let methodNames = Object.getOwnPropertyNames(objInstance);
        let instance = Object.getPrototypeOf(objInstance);
        while (instance) {
            methodNames.push(...Object.getOwnPropertyNames(instance));
            instance = Object.getPrototypeOf(instance);
            // 所有对象最底层都继承于Object，跳过Object对象的方法收集
            if (!containParent || ((_a = instance['constructor']) === null || _a === void 0 ? void 0 : _a.name) === Object.name) {
                break;
            }
        }
        for (let name of methodNames) {
            // Supposedly you'd like to skip constructor
            if (name !== 'constructor' && objInstance[name] instanceof Function) {
                names.push(name);
            }
        }
    }
    return names;
}
exports.listEs6ClassMethods = listEs6ClassMethods;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9saWIvdXRpbC91dGlscy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFDQSxTQUFnQixjQUFjLENBQUMsRUFBWSxFQUFFLEdBQVU7SUFDbkQsSUFBSSxPQUFPLEVBQUUsS0FBSyxVQUFVLEVBQUU7UUFDMUIsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBQzVEO0FBQ0wsQ0FBQztBQUpELHdDQUlDO0FBRUQsU0FBZ0IsYUFBYSxDQUFDLEVBQVksRUFBRSxJQUFXO0lBQ25ELElBQUksT0FBTyxFQUFFLEtBQUssVUFBVSxFQUFFO1FBQzFCLEVBQUUsQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0tBQ3hCO0FBQ0wsQ0FBQztBQUpELHNDQUlDO0FBRUQsU0FBZ0IsY0FBYyxDQUFDLEdBQVc7SUFDdEMsSUFBSSxDQUFDLEdBQUcsRUFBRTtRQUNOLE9BQU87S0FDVjtJQUVELElBQUksV0FBVyxHQUFHLEdBQUcsQ0FBQyxXQUFXLENBQUM7SUFDbEMsSUFBSSxDQUFDLFdBQVcsRUFBRTtRQUNkLE9BQU87S0FDVjtJQUVELElBQUksV0FBVyxDQUFDLElBQUksRUFBRTtRQUNsQixPQUFPLFdBQVcsQ0FBQyxJQUFJLENBQUM7S0FDM0I7SUFFRCxJQUFJLEdBQUcsR0FBRyxXQUFXLENBQUMsUUFBUSxFQUFFLENBQUM7SUFDakMsSUFBSSxDQUFDLEdBQUcsRUFBRTtRQUNOLE9BQU87S0FDVjtJQUVELElBQUksR0FBRyxHQUFHLElBQUksQ0FBQztJQUNmLElBQUksR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsS0FBSyxHQUFHLEVBQUU7UUFDdkIsR0FBRyxHQUFHLEdBQUcsQ0FBQyxLQUFLLENBQUMsaUJBQWlCLENB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